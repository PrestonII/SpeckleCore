version: '{build}'
image: Visual Studio 2017
before_build:
- cmd: >-
    nuget restore SpeckleCore/SpeckleCore.sln

    mkdir %appdata%\Grasshopper\Libraries\SpeckleSendReceive
build:
  publish_nuget: true
  project: SpeckleCore/SpeckleCore.sln
  verbosity: minimal
deploy:
  provider: NuGet
  server:                  # remove to push to NuGet.org
  api_key:
    secure: e4zVxpBLpMD3cSEN9siowRHilcH6ePN40rlpKCthmEgRDXNV9ZohZzpqlgCiJT3v
  skip_symbols: false
  symbol_server:           # remove to push symbols to SymbolSource.org
  artifact: /.*\.nupkg/
  on:
    branch: nuget
notifications:
- provider: Slack
  incoming_webhook:
    secure: 9Kt/ImvGdsQ/dzmRdSaMIG+BO0R29MOJC7eZZnK5m5TyWwE+4nofEcYlb/r4lh9Z1Dx/bR+7oQtgAYO3W5s+qJshkT6Is9irYw3TfMZX7/M=
  channel: '#devtalk'
  template: Build <{{buildUrl}}|#{{buildVersion}}> (<{{commitUrl}}|{{commitId}}>) of {{repositoryName}}@{{branch}}) by {{commitAuthor}} {{status}} in {{duration}}
  on_build_success: false
  on_build_failure: true
  on_build_status_changed: true
